# –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –ø—Ä–æ–µ–∫—Ç—É Coin Quest (Project-Arcade)

## 1) –ß—Ç–æ —ç—Ç–æ –∑–∞ –ø—Ä–æ–µ–∫—Ç
- **–ñ–∞–Ω—Ä/—Ç–µ—Ö**: 2D –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä –Ω–∞ **Python + Arcade**.
- **–£—Ä–æ–≤–Ω–∏**: —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ **Tiled**, —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **TMX** (`maps/map_*.tmx`), –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `arcade.load_tilemap(...)`.
- **–ü—Ä–æ–≥—Ä–µ—Å—Å/—ç–∫–æ–Ω–æ–º–∏–∫–∞**: **SQLite** —Ñ–∞–π–ª `progress.db` (—É—Ä–æ–≤–Ω–∏, —Ä–µ–∫–æ—Ä–¥—ã, —Å–∫–∏–Ω—ã).
- **–°–±–æ—Ä–∫–∞**: PyInstaller ‚Üí `release/CoinQuest.app` (macOS).

## 2) –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫/—Ñ–∞–π–ª–æ–≤ (–±—ã—Å—Ç—Ä–æ)
- **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞**: `main.py`
- **–ì–µ–π–º–ø–ª–µ–π —É—Ä–æ–≤–Ω—è**: `game.py` (–∫–ª–∞—Å—Å `MyGame`, –ø–ª—é—Å `Player`, `Particle`)
- **UI / —ç–∫—Ä–∞–Ω—ã (Arcade Views)**:
  - `menu.py` ‚Üí `MenuView` (–≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é)
  - `level_select.py` ‚Üí `LevelSelectView` (–≤—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è + —Ä–µ–∫–æ—Ä–¥—ã)
  - `pause_view.py` ‚Üí `PauseView` (–ø–∞—É–∑–∞)
  - `win_view.py` ‚Üí `WinView` (–ø–æ–±–µ–¥–∞)
  - `death_view.py` ‚Üí `DeathView` (–ø–æ—Ä–∞–∂–µ–Ω–∏–µ)
  - `shop.py` ‚Üí `ShopView` (–º–∞–≥–∞–∑–∏–Ω/–≤—ã–±–æ—Ä —Å–∫–∏–Ω–∞)
- **–î–∞–Ω–Ω—ã–µ/–ø—Ä–æ–≥—Ä–µ—Å—Å**: `database.py` (SQLite API)
- **–ó–≤—É–∫–∏**: `sounds.py` + –ø–∞–ø–∫–∞ `sounds/`
- **–†–µ—Å—É—Ä—Å—ã**:
  - `images/` (–≤ —Ç.—á. `images/characters/...`)
  - `maps/` (TMX-–∫–∞—Ä—Ç—ã)
  - `tiles.tsx`, `spritesheet-tiles-double.png` (—Ç–∞–π–ª—Å–µ—Ç –¥–ª—è Tiled)
- **–°–±–æ—Ä–∫–∞ –ø–æ–¥ macOS**: `build_mac.sh`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `README.md`, `SuperAdventures_–¢–ó.txt`, `structure.mmd`

## 3) –ö–∞–∫ –∏–≥—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (entrypoint / runtime flow)
–§–∞–π–ª `main.py`:
- –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–æ PyInstaller (`sys.frozen == True`) ‚Äî –º–µ–Ω—è–µ—Ç `cwd` –Ω–∞ –ø–∞–ø–∫—É —Ä–µ—Å—É—Ä—Å–æ–≤, —á—Ç–æ–±—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –∫ `images/`, `sounds/`, `maps/` —Ä–∞–±–æ—Ç–∞–ª–∏.
- –í—ã–∑—ã–≤–∞–µ—Ç:
  - `init_db()` ‚Äî —Å–æ–∑–¥–∞—ë—Ç/–º–∏–≥—Ä–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É —É—Ä–æ–≤–Ω–µ–π;
  - `init_skins()` ‚Äî —Å–æ–∑–¥–∞—ë—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã —Å–∫–∏–Ω–æ–≤ –∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–∫–∏–Ω–∞.
- –°–æ–∑–¥–∞—ë—Ç –æ–∫–Ω–æ `arcade.Window(..., fullscreen=True)` –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `MenuView`.

## 4) Views –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
- **`MenuView` (`menu.py`)**
  - ‚Äú–ù–∞—á–∞—Ç—å –∏–≥—Ä—É‚Äù ‚Üí `LevelSelectView`
  - ‚Äú–ú–∞–≥–∞–∑–∏–Ω‚Äù ‚Üí `ShopView`
  - ‚Äú–í—ã—Ö–æ–¥‚Äù ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ (—Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π)

- **`LevelSelectView` (`level_select.py`)**
  - –°—Ç—Ä–æ–∏—Ç –∫–Ω–æ–ø–∫–∏ —É—Ä–æ–≤–Ω–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ `database.get_levels()`.
  - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
    - —Å—Ç–∞—Ç—É—Å (‚úÖ/‚ùå),
    - —Ä–µ–∫–æ—Ä–¥ üíé (–µ—Å–ª–∏ –ø—Ä–æ–π–¥–µ–Ω),
    - —Ä–µ–∫–æ—Ä–¥ –≤—Ä–µ–º–µ–Ω–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å `best_time`).
  - –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å ‚Üí `MyGame(level_id, level_select_view=self)`

- **`MyGame` (`game.py`)**
  - `ESC` ‚Üí `PauseView(self)`
  - –ü–∞–¥–µ–Ω–∏–µ –Ω–∏–∂–µ `y < -300` ‚Üí `DeathView(level)`
  - –î–≤–µ—Ä—å (`Door`) ‚Üí –ø–æ–±–µ–¥–∞ ‚Üí –∑–∞–ø–∏—Å—å —Ä–µ–∫–æ—Ä–¥–æ–≤ –≤ –ë–î ‚Üí `WinView(...)`

- **`PauseView` (`pause_view.py`)**
  - ‚Äú–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å‚Äù ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤ –∏—Å—Ö–æ–¥–Ω—ã–π `MyGame`
  - ‚Äú–í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è‚Äù ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π `LevelSelectView` (–µ—Å–ª–∏ –±—ã–ª), –∏–Ω–∞—á–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π
  - ‚Äú–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é‚Äù ‚Üí `MenuView`
  - `ESC` –≤ –ø–∞—É–∑–µ ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å

- **`WinView` (`win_view.py`)**
  - –ö –≤—ã–±–æ—Ä—É —É—Ä–æ–≤–Ω–µ–π ‚Üí `LevelSelectView`
  - –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí `MenuView`

- **`DeathView` (`death_view.py`)**
  - ‚Äú–ù–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞‚Äù ‚Üí `MyGame(level_id)`
  - ‚Äú–ú–µ–Ω—é —É—Ä–æ–≤–Ω–µ–π‚Äù ‚Üí `LevelSelectView()`

## 5) –ö–∞—Ä—Ç—ã (TMX) –∏ –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç —Å–ª–æ—ë–≤
`MyGame.setup()` –≥—Ä—É–∑–∏—Ç `maps/map_{level}.tmx`, –µ—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç ‚Äî fallback –Ω–∞ `maps/map_2.tmx`.

–ö–æ–¥ –æ–∂–∏–¥–∞–µ—Ç —Ç–∞–∫–∏–µ —Å–ª–æ–∏/–≥—Ä—É–ø–ø—ã:
- **`Wall`** –∏ **`Platforms`**: –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ —Å—Ç–µ–Ω—ã –¥–ª—è `PhysicsEnginePlatformer`.
  - `Wall` –≤ —Å—Ü–µ–Ω—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è, –Ω–æ **–Ω–µ —Ä–∏—Å—É–µ—Ç—Å—è** (–≤ –∫–æ–¥–µ –µ—Å—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–ª–æ–π).
- **`Items`**: –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ üíé; –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏ —É–¥–∞–ª—è—é—Ç—Å—è + –∑–≤—É–∫ + —á–∞—Å—Ç–∏—Ü—ã.
- **`Door`**: –ø—Ä–∏ –∫–æ–ª–ª–∏–∑–∏–∏ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–±–µ–¥–∞ —É—Ä–æ–≤–Ω—è.
- **`Water/Lava`**: –ø—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç—Å—è –∑–≤—É–∫ –≤–æ–¥—ã/–ª–∞–≤—ã (–ª–æ–≥–∏–∫–∞ —Å–µ–π—á–∞—Å —Ç–æ–ª—å–∫–æ –∑–≤—É–∫–æ–≤–∞—è).
- **Object layer `Player`**: —Ç–æ—á–∫–∞ —Å–ø–∞–≤–Ω–∞ –∏–≥—Ä–æ–∫–∞ (–±–µ—Ä—ë—Ç—Å—è –ø–µ—Ä–≤—ã–π –æ–±—ä–µ–∫—Ç).

## 6) –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —É—Ä–æ–≤–Ω—è (`game.py`)
- **–§–∏–∑–∏–∫–∞**: `arcade.PhysicsEnginePlatformer(player, gravity_constant=GRAVITY, walls=...)`.
- **–ö–∞–º–µ—Ä–∞**:
  - `camera` —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∏–≥—Ä–æ–∫–æ–º –ø–æ `x`;
  - `gui_camera` –¥–ª—è UI (—Å—á—ë—Ç—á–∏–∫ üíé, —Ç–∞–π–º–µ—Ä, GOD MODE).
- **–°–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–æ–≤**: `arcade.check_for_collision_with_list(player, scene["Items"])`.
- **–ß–∞—Å—Ç–∏—Ü—ã**: –ø—Ä–æ—Å—Ç–æ–π —ç—Ñ—Ñ–µ–∫—Ç (10 —á–∞—Å—Ç–∏—Ü) –≤ –º–µ—Å—Ç–µ –ø–æ–¥–Ω—è—Ç–∏—è üíé.
- **–¢–∞–π–º–µ—Ä**: `level_start_time` –∏ `level_elapsed_time` –≤—ã–≤–æ–¥—è—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω.
- **God mode**: –∫–ª–∞–≤–∏—à–∞ `G`; –≤ —ç—Ç–æ–º —Ä–µ–∂–∏–º–µ –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ `change_x/change_y` –±–µ–∑ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –¥–≤–∏–∂–∫–∞.

## 7) –ò–≥—Ä–æ–∫ –∏ —Å–∫–∏–Ω—ã (`Player` –≤ `game.py`)
- –¢–µ–∫—É—â–∏–π —Å–∫–∏–Ω –±–µ—Ä—ë—Ç—Å—è –∏–∑ –ë–î: `database.get_selected_skin()`.
- –û–∂–∏–¥–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã —Å–ø—Ä–∞–π—Ç–æ–≤:
  - idle: `images/characters/{skin}.png`
  - jump: `images/characters/{skin}_jump.png`
  - walk: –¥–æ 8 –∫–∞–¥—Ä–æ–≤:
    - `images/characters/{skin}walk{i}.png` (—Å–ª–∏—Ç–Ω–æ) **–∏–ª–∏**
    - `images/characters/{skin}_walk{i}.png` (—á–µ—Ä–µ–∑ `_`)
- –ï—Å–ª–∏ –∫–∞–∫–∏–µ-—Ç–æ —Ç–µ–∫—Å—Ç—É—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –µ—Å—Ç—å fallback (idle –∏–ª–∏ –∫—Ä–∞—Å–Ω—ã–π –∫—Ä—É–≥).

## 8) –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite) ‚Äî `database.py`
–§–∞–π–ª –ë–î: `progress.db`

### –¢–∞–±–ª–∏—Ü–∞ `levels`
- `id INTEGER PRIMARY KEY` (—Å–µ–π—á–∞—Å —Å–æ–∑–¥–∞—é—Ç—Å—è —É—Ä–æ–≤–Ω–∏ **1..4**)
- `completed INTEGER DEFAULT 0`
- `crystals INTEGER DEFAULT 0` (—Ö—Ä–∞–Ω–∏—Ç—Å—è –º–∞–∫—Å–∏–º—É–º)
- `best_time REAL` (–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏–µ–π, –µ—Å–ª–∏ –∫–æ–ª–æ–Ω–∫–∏ –µ—â—ë –Ω–µ—Ç)

–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- `init_db()` ‚Äî —Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É –∏ —É—Ä–æ–≤–Ω–∏, –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–ª–æ–Ω–∫—É `best_time` –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
- `get_levels()` ‚Äî —Å–ø–∏—Å–æ–∫ —É—Ä–æ–≤–Ω–µ–π –¥–ª—è –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è.
- `complete_level(level_id, crystals)` ‚Äî –∑–∞–≤–µ—Ä—à–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –º–∞–∫—Å–∏–º—É–º üíé.
- `get_level_crystals(level_id)` ‚Äî —Ä–µ–∫–æ—Ä–¥ üíé –ø–æ —É—Ä–æ–≤–Ω—é.
- `get_level_time(level_id)` / `update_level_time(level_id, seconds)` ‚Äî —Ä–µ–∫–æ—Ä–¥ –≤—Ä–µ–º–µ–Ω–∏.

### –¢–∞–±–ª–∏—Ü—ã —Å–∫–∏–Ω–æ–≤
- `skins(id, name, cost, unlocked)`
- `player_skin(selected_skin)` ‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–∫–∏–Ω (–æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å)

`init_skins()` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫:
- `character_1` (cost 0)
- `character_2` (cost 10)
- `character_3` (cost 20)

## 9) –ú–∞–≥–∞–∑–∏–Ω (`shop.py`)
- –°—á–∏—Ç–∞–µ—Ç **total_crystals** –∫–∞–∫ —Å—É–º–º—É —Ä–µ–∫–æ—Ä–¥–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—è–º **1..4**:
  - `sum(get_level_crystals(i) for i in range(1, 5))`
- –ï—Å–ª–∏ —Å–∫–∏–Ω –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –Ω–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Å–∫–∏–Ω–∞:
  - `select_skin(name)` ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã–±–æ—Ä –≤ –ë–î
  - `sounds.change_skin.play()` ‚Üí –∑–≤—É–∫ —Å–º–µ–Ω—ã

## 10) –ó–≤—É–∫–∏ (`sounds.py`)
- –í—Å–µ –∑–≤—É–∫–∏ –≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ `safe_load_sound(path)`.
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è `DummySound` (—á—Ç–æ–±—ã –∏–≥—Ä–∞ –Ω–µ –ø–∞–¥–∞–ª–∞).

## 11) –°–±–æ—Ä–∫–∞ –ø–æ–¥ macOS (`build_mac.sh`)
–°–∫—Ä–∏–ø—Ç:
- —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–π `release/CoinQuest.app`
- –∑–∞–ø—É—Å–∫–∞–µ—Ç PyInstaller –¥–ª—è `main.py` –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å—ã:
  - `images`, `sounds`, `maps`, `tiles.tsx`
- —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `release/CoinQuest.app`

## 12) –ß–∞—Å—Ç—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∫—É–¥–∞ —Å–º–æ—Ç—Ä–µ—Ç—å)
- **–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å**:
  - –¥–æ–±–∞–≤–∏—Ç—å `maps/map_N.tmx`
  - —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ü–∏–∫–ª —É—Ä–æ–≤–Ω–µ–π –≤ `database.init_db()` (–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–∏–∞–ø–∞–∑–æ–Ω –≤ `shop.py` –¥–ª—è —Å—É–º–º—ã –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤)
- **–î–æ–±–∞–≤–∏—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å —Å–∫–∏–Ω**:
  - –¥–æ–±–∞–≤–∏—Ç—å —Å–ø—Ä–∞–π—Ç—ã –≤ `images/characters/`
  - –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ `actual_skins` –≤ `database.init_skins()`
- **–ü–µ—Ä–µ—Ö–æ–¥—ã/–∫–Ω–æ–ø–∫–∏ UI**: `menu.py`, `level_select.py`, `pause_view.py`, `win_view.py`, `death_view.py`

